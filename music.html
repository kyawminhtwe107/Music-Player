<!DOCTYPE html>
<html>
	<head>
		<title>Music Player</title>
		<link rel="stylesheet" type="text/css" href="style.css">

		<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->

		<script src="https://kit.fontawesome.com/cbd8629d2f.js" crossorigin="anonymous"></script>

		<script type="text/javascript" src="song.js"></script>
	</head>
	<body>
		<div class="container">
			
			<div class="content">

				<nav>
					<div class="circle">
						<i class="fa-solid fa-arrow-left"></i>					
					</div>
					<div class="circle">
						<i class="fa-solid fa-bars"></i>
					</div>
				</nav>

				<div class="info" id="songInfo">
					
				</div>

				<div class="play">
					<!-- <audio id="song">
						<source src="sample.mp3" type="audio/mpeg">
					</audio> -->
					<audio id="song" src="sample.mp3"></audio>
					<input type="range" value="0" id="progress">
				</div>

				<div class="action">
					
					<div class="indexBtn" onclick="indexHandler('prev')">
						<i class="fa-solid fa-backward"></i>
					</div>

					<div class="playBtn" onclick="play()">
						<i class="fa-solid fa-play" id="playBtn"></i>
					</div>

					<div class="indexBtn" onclick="indexHandler('next')">
						<i class="fa-solid fa-forward"></i>
					</div>

				</div>
				
			</div>

		</div>

		<script type="text/javascript">

			let x = 0;
			
			let progress = document.getElementById('progress')
			let song = document.getElementById('song')
			let playBtn = document.getElementById('playBtn')

			song.onloadedmetadata = function() {
				progress.max = song.duration
				progress.value = song.currentTime
			}

			songHandler()

			function songHandler(index = 0) {

				let songInfo = document.getElementById('songInfo');

				let html = `
						<img
							src="${songs[index]['cover']}"
							class="img"
						/><br/>
						<h3>${songs[index]['title']}</h3>
						<small>${songs[index]['name']}</small>
				`

				song.src = songs[index]['song']

				songInfo.innerHTML = html

			}

			function indexHandler(status = 'next'){
				if(status == 'next'){
					if(songs.length > x){
						x += 1
					}
				}
				else {
					if(x > 0){
						x -= 1
					}
				}

				songHandler(x)
			}


			function play() {
				if(playBtn.classList.contains('fa-pause')){
					song.pause();
					playBtn.classList.remove('fa-pause')
					playBtn.classList.add('fa-play')
				}
				else {
					song.play();

					playBtn.classList.add('fa-pause')
					playBtn.classList.remove('fa-play')
				}
			}

			if(song.play()){
				setInterval(() => {
					progress.value = song.currentTime
				},500)
			}

			progress.onchange = function () {
				song.currentTime = progress.value

				song.play()

				playBtn.classList.add('fa-pause')
				playBtn.classList.remove('fa-play')
			}

		</script>

	</body>
</html>